<html>
  <head>
    <script language="javascript" src="rts2.js"></script>
    <script language="javascript" src="lib2.js"></script>
    <script language="javascript" src="out2.js"></script>

    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>


    <link rel="stylesheet"
    href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
    integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7"
    crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet"
    href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css"
    integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r"
    crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script
    src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"
    integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS"
    crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>


<!--    <script
src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
<script src="lang-hs.js"></script> -->

    <script src="sh_main.min.js" > </script>
    <script src="sh_haskell.min.js" > </script>
    <link rel="stylesheet" type="text/css" href="sh_style.css" />

    <script src="blockly/blockly_compressed.js"></script>
    <script src="blockly/blocks_compressed.js"></script>
    <script src="blockly/msg/js/en.js"></script>
    <script src="blockly/javascript_compressed.js"></script>

    <script src="codeworld.js"></script> 
    <script src="codegen.js"></script>
    
    <script>


    Blockly.Blocks['cw_number'] = {
      init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("10"), "NUMBER");
        this.setOutput(true, 'Number');
        this.setColour(210);
        this.setTooltip('Enter a number');
      }
    };

    Blockly.Blocks['cw_drawingOf'] = {
      init: function() {
        this.setColour(00);
        this.appendValueInput('VALUE')
            .setCheck('Picture')
            .setAlign(Blockly.ALIGN_RIGHT)
            .appendField('drawingOf');
        //this.setOutput(true, 'Program');
        this.setTooltip('Displays the drawing of the provided picture');
      }
    };

    Blockly.Blocks['cw_text'] = {
      init: function() {
        this.setColour(160);
        this.appendDummyInput()
           // .setCheck('String')
           // .setAlign(Blockly.ALIGN_RIGHT)
            .appendField('text')
            .appendField(new Blockly.FieldTextInput('Pandas here'), 'TEXT' );
        this.setOutput(true, 'Picture');
        // this.setTooltip('Displays the drawing of the provided picture');
      }
    };

    Blockly.Blocks['cw_combine'] = {
      init: function() {
      this.appendDummyInput()
        .appendField("Combine");
      this.appendValueInput("Comb1")
        .setCheck("Picture")
        .appendField("Picture");
      this.appendValueInput("Comb2")
        .setCheck("Picture")
        .appendField("Picture");
      this.setInputsInline(false);
      this.setOutput(true, "Picture");
      this.setColour(160);
      this.setTooltip('Combines two pictures');
     }
    };
    Blockly.Blocks['cw_translate'] = {
      init: function() {
        this.appendDummyInput()
            .appendField("Translate");
        this.appendValueInput("PICTURE")
            .setCheck("Picture")
            .appendField("Picture");
        this.appendValueInput("X")
            .setCheck('Number')
            .appendField("x");
        this.appendValueInput("Y")
            .setCheck('Number')
            .appendField("y");
        this.setInputsInline(true);
        this.setOutput(true, "Picture");
        this.setColour(160);
        this.setTooltip('Translate a picture');
      }
    };

  </script>


  <style>
    .blocklyToolboxDiv
    {
      background-color: white !important; 
    };
    path .blocklyFlyoutBackground
    {
      /* fill: #000 !important; */
    };

  </style>


  </head>


  <body onload="sh_highlightDocument();">
  <div class="container-fluid">
    <div class="row full">
        <div id="sidebar" class="col-md-1">
  
            <h3>Fun Blocks</h3>
            <ul class="nav nav-pills nav-stacked">
                <li class="active"><a href="#">CodeWorld</a></li>
                <li><a href="#">Definitions</a></li>
                <li><a href="#">Link 2</a></li>
            </ul>
        </div>
        <div id="main" class="col-md-6">
            <div class="row">
              <h3>CodeWorld Blocks</h3>
                <div class="col-md-12">

                  <xml id="toolbox" style="display: none">
                      <category name="Pictures">
                          <block type="cw_translate"></block>
                          <block type="cw_combine"></block>
                          <block type="cw_drawingOf"></block>
                          <block type="cw_text"></block>
                      </category>
                      <category name="Math">
                          <block type="cw_number"></block>
                      </category>
                      <category name="Temp">
                          <block type="controls_if"></block>
                          <block type="math_arithmetic"></block>
                          <block type="text"></block>
                      </category>

                   </xml>

                <div id="blocklyDiv" style="height: 900px; width:100%;"> </div>

                </br>
                <div class="btn-group" role="group" aria-label="...">
                    <!-- <button type="button" class="btn btn-primary"
                      id="btnBuild">Build</button> -->
                    <button type="button" class="btn btn-success" id="btnRun">Run</button>
                    <!-- <button type="button" class="btn btn-warning" id="btnBoom">Boom</button>
                    <button type="button" class="btn btn-warning"
                    id="btnBam">Bam</button> -->
                </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
          <h3>CodeWorld</h3>
          <div id="result">
            <iframe id="runner" class="dropbox" width="500" 
              height="500"></iframe>
              <pre id="message" class="dropbox" style="width:500px;">
              </pre>
          </div>
          <h4>Generated Code:</h4>
          <pre id="genCode" class="sh_haskell" style="width:500px; height:400px;">
test :: a -> b -> Int
fib 0 = 0
fib 1 = 1
fib n = fib (n-1) + fib (n-2)
main :: IO ()
main      = animationOf(design)
design(t) = rotated(slot, 60 * t) & middle & outside
slot      = solidRectangle(4, 0.4)
middle    = solidCircle(1.2)
outside   = circle(2)
          </pre> 
        </div> 
    </div>
  </div>

  <!-- TODO, rewrite with GHCJS -->
  
  <script src="runmain2.js"></script> 
    
  <!-- <script>
    var workspace = Blockly.inject('blocklyDiv',
      {toolbox: document.getElementById('toolbox')});
  </script> 

  <script>
  $('#btnBuild').on('click', function(event) {
    event.preventDefault(); 
    var code = Blockly.FunBlocks.workspaceToCode(workspace);
    alert(code);
  });
  
  $('#btnRun').on('click', function(event) {
    event.preventDefault();

    var src = Blockly.FunBlocks.workspaceToCode(workspace);

    compile(src);
    run();
    
  });
  $('#btnBoom').on('click', function(event)
      {
        event.preventDefault();
        alert('compiling');
        var src = $('#genCode').text();
        alert(src);
        compile(src);
        run();
      });

  </script> -->

  </body>

</html>
